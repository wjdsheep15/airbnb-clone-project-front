__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.initRemarketingDataV2=function(t,v=!1){const p="/v2/get-data-layer-variables",$=`${p}/${(0,o.getBev)()}`,_=s.default.current().id||(0,o.getBev)(),y=`${p}/${_}`;if(v){const t=(0,n.default)(y);if(t)return s.default.isLoggedIn()&&(0,n.default)($,t,{expires:c}),Promise.resolve(t)}return new Promise((o=>{f().default.post(`/api${p}`,{body:JSON.stringify(t||{})}).then((t=>{const f={...t,event_id:(0,u().v4)()};return v&&((0,n.default)(y,f,{expires:c}),s.default.isLoggedIn()&&(0,n.default)($,f,{expires:c})),o(f)})).catch((()=>{o(l)}))}))};var n=t(r(d[1]));function u(){const t=r(d[2]);return u=function(){return t},t}var o=r(d[3]),s=t(r(d[4]));t(r(d[5]));function f(){const n=t(r(d[6]));return f=function(){return n},n}const c=864e5,l={}}),"1949a1",["ba7a76","1f339e","305dd5","4304c2","06a99e","c235f8","69a7c4"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default,n=r(d[1]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.updateP2Remarketing=function({filters:t,listingIds:n=[],geography:s,remarketingIds:c,canonicalLocation:o}){const _=new RegExp("=(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))(&|$)"),l=decodeURIComponent(window.location.href),y=_.test(l);y&&u.default.logEvent({event_name:'urls_with_pii',event_data:{url:l,datadog_key:'paid_growth.urls_with_pii',datadog_tags:'source:p2'}});return L({canonicalLocation:o,categoryTag:t.category_tag||'',checkin:t.checkin||'',checkout:t.checkout||'',topListingIds:Array.isArray(c)&&c.length>0?c.slice(0,10):n.slice(0,10),city:s?s.city:'N/A',state:s?s.state:'N/A',country:s?s.country:'N/A',num_adults:t.adults||1,num_children:t.children||0,num_infants:t.infants||0,filters:t,remarketingIds:c,resultIds:n,urlContainsPII:y})};var s=n(r(d[2]));function c(){const t=r(d[3]);return c=function(){return t},t}var o=r(d[4]),u=n(r(d[5])),_=n(r(d[6])),l=n(r(d[7])),y=r(d[8]),h=n(r(d[9])),p=r(d[10]),f=t(r(d[11]));function k(){const t=n(r(d[12]));return k=function(){return t},t}const v='searchresults',I='optout';function b({canonicalLocation:t,categoryTag:n,checkin:p,checkout:I,topListingIds:b,city:L,state:S,country:P,num_adults:w,num_children:x,num_infants:A,filters:N,remarketingIds:T,resultIds:E,urlContainsPII:C},D){const R=h.default.makeGoogleDynxParams(v,b,p,I);if(R.dynx_pagetype='p2',R.dynx_itemid=(0,y.locationToURLParameter)(t).toLowerCase(),(0,f.pushEventsToDataLayer)([{data:{dynx_params:R,urlContainsPII:C}},{event:'searchListings',data:{user_country:s.default.country(),top_listing_ids:b,city:L,state:S,country:P,num_adults:w,num_children:x,num_infants:A,...D}}]),k().default.post("/api/v2/marketing_event_tracking",{body:JSON.stringify({event_type:'SEARCH_LISTINGS',event_data:{audience_type:D.audience_type,category_tag:n,checkin_date:p,checkout_date:I,city:L,country:P,has_account:h.default.hasAccount().toString(),num_adults:w?.toString(),num_children:x?.toString(),num_infants:A?.toString(),searched_string:N.location,state:S}})}),N.work_trip&&(0,f.default)({event:'workTripSearchListings',data:{user_country:s.default.country()}}),p&&I&&(0,f.default)({event:'searchListingsWithDates',data:{user_country:s.default.country()}}),l.default.getBootstrap('remarketing_jitney_logging'))try{const t=JSON.stringify({...D,city:L,region:S,country:P,user_country:s.default.country(),dynxParams:R});u.default.logJitneyEvent({schema:c().PaidGrowthHomeSearchPixelEvent,event_data:{search_results:(E||[]).map(Number),search_results_str:E||[],remarketing_ids:(T||[]).map(Number),remarketing_ids_str:T||[],subtab:2,device_id:(0,o.getBev)()||'',user_id:_.default.current().id,checkin_date:N.checkin,checkout_date:N.checkout,guests:N.guests||1,adults:N.adults||1,children:N.children,infants:N.infants,pets:N.amenities&&N.amenities.includes(12),instant_book:N.ib,price_min:N.price_min,price_max:N.price_max,room_types:N.room_types?N.room_types.map((t=>'Entire home/apt'===t?3:'Private room'===t?2:'Shared room'===t?1:3)):void 0,beds:N.min_beds,bedrooms:N.min_bedrooms,bathrooms:N.min_bathrooms,amenities:N.amenities,audience_type:D.audience_type,custom_data:t}})}catch(t){}}function L(t){return(0,p.initRemarketingDataV2)({userId:_.default.current()?.id,bevId:(0,o.getBev)()}).then((n=>{n&&n.userData.audienceType!==I&&b(t,{event_id:n.event_id,audience_type:n.userData.audienceType})}))}}),"26b25a",["45f788","ba7a76","862e50","af12d7","4304c2","c8b97a","06a99e","c235f8","f4229b","387550","1949a1","c1f92a","69a7c4"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=t(r(d[1])),l=t(r(d[2])),c=t(r(d[3])),n=t(r(d[4])),u=r(d[5]);const s=l.default.format('rails_format'),f='YYYY-MM-DD',h='YYYY-MM-DD';var _={localizedToCriteoDate:t=>t?(0,o.default)(t,s).format('MM/DD/YYYY'):'',localizedToGoogleDate:t=>t?(0,o.default)(t,f,!0).isValid()?t:(0,o.default)(t,s).format(f):'',hasAccount:()=>null!=n.default.current().id||!!(0,c.default)('hli'),makeGoogleDynxParams(t,o,l,c){return{hrental_pagetype:t,hrental_id:o,hrental_startdate:this.localizedToGoogleDate(l),hrental_enddate:this.localizedToGoogleDate(c),has_account:this.hasAccount()}},saveSearchFilters(t){if(!t.checkin||!t.checkout)return;const l=(0,o.default)(t.checkin,h,!0).isValid()?(0,o.default)(t.checkin,h):(0,o.default)(t.checkin,s),n=(0,o.default)(t.checkout,h,!0).isValid()?(0,o.default)(t.checkout,h):(0,o.default)(t.checkout,s),f=t.guests?String(t.guests):'',_=t.adults?String(t.adults):'',Y=t.children?String(t.children):'',D=t.infants?String(t.infants):'';let k=0;if(t.room_types)for(let o=0;o<t.room_types.length;o+=1){const l=t.room_types[o];'Entire home/apt'===l?k+=1:'Private room'===l?k+=2:'Shared room'===l&&(k+=4)}(0,c.default)('lsf',l.format(h).concat(',',n.format(h),',',f,',',_,',',Y,',',D,',',String(k)),{expires:l.diff((0,o.default)(),'days')+1,path:'/',domain:(0,u.getCookieHost)()})}};e.default=_}),"387550",["ba7a76","1772c9","30735e","e7272f","06a99e","5b85ba"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PaidGrowthHomeSearchPixelEvent=void 0;var o={defaultProps:{schema:'com.airbnb.jitney.event.logging.PaidGrowth:PaidGrowthHomeSearchPixelEvent:4.0.0',event_name:'paidgrowth_home_search_pixel',operation:20},propTypes:{}};e.PaidGrowthHomeSearchPixelEvent=o,o.fullyQualifiedName='PaidGrowth.v4.PaidGrowthHomeSearchPixelEvent'}),"af12d7",[]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;function n(){const t=r(d[1]);return n=function(){return t},t}Object.defineProperty(e,"__esModule",{value:!0}),e.default=v,e.pushEventsToDataLayer=function(t){t.forEach((t=>v(t)))};var o=t(r(d[2])),u=r(d[3]);function v({event:t,data:v={},eventCallback:c,eventTimeout:l}){{window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:t,...c&&{eventCallback:()=>{c()}},...l&&{eventTimeout:l},...v});const s=Object.fromEntries(Object.entries(v).map((([t,n])=>[t,String(n)])));o.default.logJitneyEvent({schema:n().GoogleTagManagerDataLayerPushEvent,event_data:{data_layer_event_name:t||'',data_layer_event_data:s}}),(0,u.airdogCount)('gtm.datalayer.push',1,[`event:${t||''}`])}}}),"c1f92a",["ba7a76","cd167e","c8b97a","3e4681"]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GoogleTagManagerDataLayerPushEvent=void 0;var o={defaultProps:{schema:'com.airbnb.jitney.event.logging.GoogleTagManager:GoogleTagManagerDataLayerPushEvent:1.0.0',event_name:'googletagmanager_data_layer_push'},propTypes:{}};e.GoogleTagManagerDataLayerPushEvent=o,o.fullyQualifiedName='GoogleTagManager.v1.GoogleTagManagerDataLayerPushEvent'}),"cd167e",[]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(d[1]),c=r(d[2]),s=r(d[3]),o=t(r(d[4])),u=r(d[5]),E=r(d[6]),l=r(d[7]);function f(t){switch(t){case u.EXPLORE_TABS.SELECT_HOMES:case u.EXPLORE_TABS.HOMES:case u.EXPLORE_TABS.LUXURY:return'homes';case u.EXPLORE_TABS.EXPERIENCES:case u.EXPLORE_TABS.ADVENTURES:return'experiences';default:return null}}var p=function(t){const{remarketingIds:u,canonicalLocation:p,city:h,state:R,country:_}=t,y=(0,o.default)(),{checkin:P,checkout:S,adults:T,children:k,infants:v,pets:L,category_tag:O}=y,X=(0,n.useRef)(y);X.current=y;const{abort:A,scheduler:B}=(0,E.usePostTaskScheduler)({priority:'background',strategy:'recycle'});return(0,n.useEffect)((()=>{const t=(0,l.getTabFromRefinementPaths)(X.current.refinement_paths),n={city:h??void 0,state:R??void 0,country:_??void 0};return'homes'===f(t)?B.postTask((()=>{(0,c.updateP2Remarketing)({canonicalLocation:p||'',filters:X.current,geography:n,listingIds:[],remarketingIds:u||void 0})})):'experiences'===f(t)&&B.postTask((()=>{(0,s.updateP2RemarketingExperience)({filters:X.current,geography:n})})),A}),[h,_,R,p,P,S,T,k,v,L,O,A,B]),null};e.default=p}),"d31cce",["ba7a76","a27fc3","26b25a","dbc503","f98e43","87916a","53bb4a","aea415"]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.updateP2RemarketingExperience=function({filters:t,geography:n}){const{checkin:c,checkout:f,adults:s,children:h,infants:o,refinement_paths:l}=t,y=l&&l[0]||'',p=y.split('/').pop();u({checkin:c||'',checkout:f||'',city:n?n.city:'N/A',state:n?n.state:'N/A',country:n?n.country:'N/A',numOfAdults:s||1,numOfChildren:h||0,numOfInfants:o||0,refinementPath:y,refinement:p})};var n=t(r(d[1])),c=t(r(d[2]));function u({checkin:t,checkout:u,city:f,state:s,country:h,numOfAdults:o,numOfChildren:l,numOfInfants:y,refinementPath:p,refinement:O}){(0,c.default)({event:'searchExperiences',data:{user_country:n.default.country(),city:f,state:s,country:h,checkin:t,checkout:u,numOfAdults:o,numOfChildren:l,numOfInfants:y,refinementPath:p,refinement:O}}),(t||u)&&(0,c.default)({event:'searchExperiencesWithDates',data:{user_country:n.default.country()}})}}),"dbc503",["ba7a76","862e50","c1f92a"]);
//# sourceMappingURL=https://sourcemaps.d.musta.ch/airbnb/static/packages/web/common/frontend/stays-search/sections/client/StaysRemarketing/StaysRemarketing.8afb441434.js.map